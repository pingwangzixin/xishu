<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="applicable-device" content="mobile">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <title>Datahoop 2.0 建议反馈</title>
    <link rel="icon" href="img/favicon.png?v=0.19.11.21.11" type="image/x-icon">
    <link rel="shortcut icon" href="img/favicon.png?v=0.19.11.21.11" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="css/bootstrapx.css?v=0.19.11.21.11">
    <link rel="stylesheet" type="text/css" href="css/summernote.css?v=0.19.11.21.11">
    <link rel="stylesheet" type="text/css" href="css/nav.css?v=0.19.11.21.11">
    <link rel="stylesheet" type="text/css" href="css/feedback.css?v=0.19.11.21.11">
    <link rel="stylesheet" type="text/css" href="css/style.css?v=0.19.11.21.11">
    <script type="text/javascript" src="js/jquery.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/jqueryx.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/bootstrapx.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/summernote.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/summernote-zh-CN.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/url_ip.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/nav.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/lajax.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/feedback.js?v=0.19.11.21.11"></script>

    <style>

    </style>

    <script>
        /*假数据  开始*/
        //        var msg ={
        //            'success':true,
        //            'status':true,
        //            "data": [
        //                {
        //                    "id": "1",
        //                    "title": "反馈标题1111111",
        //                    "status": "当前状态1",
        //                    "content": "在职场充电中,点击课程,(全套) 加入购物车候,弹出的 已添加成功,请到个人中心-我的收纳中下方的查看按钮无法点击,还是要点击个人中心,再点我的收纳中查看购买",
        //                    "add_time": "2019-05-15"
        //                },
        //                {
        //                    "id": "2",
        //                    "title": "反馈标题2",
        //                    "status": "当前状态2",
        //                    "content": "在职场充电中,点击课程,(全套) 加入购物车候,弹出的 已添加成功,请到个人中心-我的收纳中下方的查看按钮无法点击,还是要点击个人中心,再点我的收纳中查看购买",
        //                    "add_time": "2019-05-15"
        //                },
        //                {
        //                    "id": "3",
        //                    "title": "反馈标题3",
        //                    "status": "当前状态3",
        //                    "content": "在职场充电中,点击课程,(全套) 加入购物车候,弹出的 已添加成功,请到个人中心-我的收纳中下方的查看按钮无法点击,还是要点击个人中心,再点我的收纳中查看购买",
        //                    "add_time": "2019-05-15"
        //                },
        //                {
        //                    "id": "4",
        //                    "title": "反馈标题4",
        //                    "status": "当前状态4",
        //                    "content": "在职场充电中,点击课程,(全套) 加入购物车候,弹出的 已添加成功,请到个人中心-我的收纳中下方的查看按钮无法点击,还是要点击个人中心,再点我的收纳中查看购买",
        //                    "add_time": "2019-05-15"
        //                },
        //                {
        //                    "id": "5",
        //                    "title": "反馈标题5",
        //                    "status": "当前状态5",
        //                    "content": "在职场充电中,点击课程,(全套) 加入购物车候,弹出的 已添加成功,请到个人中心-我的收纳中下方的查看按钮无法点击,还是要点击个人中心,再点我的收纳中查看购买",
        //                    "add_time": "2019-05-15"
        //                }
        //            ]};
        //         var message ={
        //             'success':true,
        //             'status':true,
        //             "data": [
        //                 {
        //                     "user": "用户id",
        //                     "username": "超级管理员",
        //                     "status": "当前状态1",
        //                     "content": "非常感谢你提供的问题经过测试,点击[查看]按钮确实无法跳转我的收纳页,我们会尽快修复这个问题",
        //                     "add_time": "2019-05-15"
        //                 }
        //             ]};
        /*假数据  结束*/

        //        $(document).ready(function(){
        //            /*这是调取的死数据,如需调取接口,屏蔽即可  开始*/
        ////            var array_json = eval(msg);
        ////            if(array_json.status){
        ////                eachArr(array_json);
        ////            }
        ////            return;
        //            /*这是调取的死数据 结束*/
        //            getList(1);
        //        })
        //        /*
        //        获取列表
        //         */
        //        function getList(page){
        //            var url = url_ip+"/personal/question";
        //            var timestamp = (new Date()).getTime();
        //            $.ajax({
        //                type:'GET',
        //                url:url,
        //                data:{'page':page,'_':timestamp},
        //                dataType:"json",
        //                headers:{"Authorization":token},
        //                success:function(msg){
        //                    var array_json = eval(msg);
        //                    if(array_json.status){
        //                        eachArr(array_json);
        //                    }
        //                },
        //                error:function(msg){
        //                    alert("网络错误,请重试");
        //                    return false;
        //                }
        //            });
        //        }
        //        /*
        //        展示列表
        //         */
        //        function eachArr(array_json){
        //            //解析数组
        //            var str = "";
        //            $.each(array_json.data, function(key,v){
        //                var id= v['id'];
        //                str += ('<div class="lass huifu'+id+'">');
        //                str += ('<div style="overflow:hidden;width:953px">');
        //                str += ('<div style="float:left;width:529px">');
        //                str += ('<span style="font-size: 16px">'+v['title']+'</span>');
        //                str += ('<a href="javascript:;" style="cursor:pointer;" title="点击回复" onclick="getInfo('+id+')">');
        //                str += ('<p class="dian">'+v['content']+'</p>');
        //                str += ('</a>');
        //                str += ('</div>');
        //                str += ('<div style="float:right">');
        //                str += ('<span class="data">'+v['add_time']+'</span>');
        //                str += ('</div>');
        //                str += ('</div>');
        //                str += ('</div>');
        //            });
        //            $("#div_feedback").append(str);
        //        }


        function GetRequest() {
            var url = location.search; //获取url中"?"符后的字串
            var theRequest = new Object();
            if (url.indexOf("?") != -1) {
                var str = url.substr(1);
                strs = str.split("&");
                for (var i = 0; i < strs.length; i++) {
                    theRequest[strs[i].split("=")[0]] = decodeURIComponent(strs[i].split("=")[1]);
                }
            }
            return theRequest;
        }

        /*获取id,根据id获取详情*/
        $(document).ready(function () {
            var getArr = GetRequest();
            Info(getArr);
        })

        function Info(getArr) {
            $.GSHajax({
                url: '/personal/answer',
                data: {
                    'id': getArr.id
                },
                type: 'GET',
                datatype: 'json',
                cache: false,
                success: function (msg) {
                    var str = "";
                    str += ('<div class="lass engind huifu' + getArr.id + '">');
                    str += ('<div style="overflow:hidden;width:998px;color:#606266">');
                    str += ('<div');
                    str += ('<span style="font-size: 16px">' + msg.data[0].title + '</span>');
                    str += ('<span class="data">' + msg.data[0].add_time + '</span>');
                    str += ('<div class="dian">' + msg.data[0].content + '</div>');
                    str += ('</div>');
                    str += ('<div style="float:right">');
                    str += ('</div>');
                    str += ('</div>');
                    str += ('</div>');
                    $("#div_feedback").append(str);
                    getInfo(getArr['id']);
                    for (var i = 0; i < $(".dian p img").length; i++) {
                        if ($(".dian p img").eq(i).width() > $(".dian p img").eq(i).height() && $(".dian p img").eq(i).height() < "540px") {
                            $(".dian p img").eq(i).css("width", "100%");
                        } else {
                            $(".dian p img").eq(i).css({
                                "height": "540px",
                                "width": "auto",
                                "display": "flex",
                                "margin": "0 auto"
                            });
                            $(".dian p img").eq(i).wrap("<div class='wrap'></div>");
                        }
                    }
                }
            })
        }

        /*
        获取详情
         */
        function getInfo(id) {
            /*这是调取的死数据,如需调取接口,屏蔽即可  开始*/
            // var array_json = eval(message);
            // getInfoStr(array_json,id);
            // return ;
            /*这是调取的死数据  结束*/
            var url = url_ip + "/personal/answer";
            var timestamp = (new Date()).getTime();
            $.GSHajax({
                url: '/personal/answer',
                data: {
                    'id': id,
                    '_': timestamp
                },
                type: 'GET',
                datatype: 'json',
                cache: false,
                success: function (msg) {
                    var array_json = eval(msg);
                    if (array_json.data == "") {
                        $(".yijing").html(array_json.msg);
                        $('.jhFengexian').show();
                    } else {
                        getInfoStr(array_json, id);
                    }
                }
            })
        }

        /*
        详情js填充
         */
        function getInfoStr(array_json, id) {
            $(".dap").remove();
            var str = "";
            var array_json2 = array_json.data;
            array_json2 = array_json2.splice(1, array_json2.length);
            $.each(array_json2, function (key, v) {
                str += ('<div class="dap">');
                if (array_json.status) {
                    // alert(v['username']);
                    str += ('<div>');
                    str += ('<div class="den">');
                    str += ('<h3 class="poen">' + v.username + ':</h3>');
                    str += ('<div class="miss">' + v.content + '</div>');
                    str += ('</div>');
                    str += ('<div class="wir">');
                    str += ('<span>' + v.add_time + '</span>');
                    str += ('</div>');
                    str += ('</div>');
                }
            });
            // 回复功能暂时隐藏;
            // str += ('<p class="fu"><a href="#">回复</a></p>');
            // str += ('<p class="nam"></p>');
            // str += ('<div class="m"><div class="summernote" prl></div></div>')
            // str += ('<div>');
            // str += ('<input type="button" value="发送" class="send" onclick="postSubmit(' + id + ')">');
            // str += ('</div>');
            // 回复功能暂时隐藏;
            str += ('<div>');
            str += ('</div>');
            str += ('</div>');
            var huifu = ".huifu" + id;
            $(huifu).append(str);
            for (var i = 0; i < $(".miss p img").length; i++) {
                if ($(".miss p img").eq(i).width() > $(".miss p img").eq(i).height() && $(".miss p img").eq(i).height() < "540") {
                    $(".miss p img").eq(i).css("width", "895px");
                } else {
                    $(".miss p img").eq(i).css({
                        "height": "540px",
                        "width": "auto",
                        "display": "flex",
                        "margin": "0 auto"
                    });
                    $(".miss p img").eq(i).wrap("<div class='wrap'></div>");
                }
            }
            $('.summernote').summernote({
                height: 200,
                tabsize: 2,
                lang: 'zh-CN'
            });
        }

        /*
        提交评论
         */
        var tijiao = 1;

        function postSubmit(id) {
            for (var i = 0; i < $(".m .note-editable img").length; i++) {
                $.ajax({
                    type: "POST",
                    url: url_ip + '/admins/uedimgsave/',
                    async: false,
                    data: {
                        cover: $(".m .note-editable img").eq(i).attr("src")
                    },
                    dataType: "json",
                    headers: {
                        "Authorization": token
                    },
                    success: function (data) {
                        $(".m .note-editable img").eq(i).attr("src", data.data);
                    }
                });
            }
            $(".note-editable").attr("id", "content");
            var timestamp = (new Date()).getTime();
            var content = $("#content").html();
            if (content == "" || content == null || content == undefined || content == "<p><br></p>") {
                alert("请输入回复内容");
                return false;
            }
            if (id == "" || id == null || id == undefined) {
                alert("网络错误,请刷新重试");
                return false;
            }
            if (tijiao == 2) {
                return false;
            }
            tijiao = 2;
            var url = url_ip + "/personal/answer";
            $.ajax({
                type: 'post',
                url: url,
                async: false,
                data: {
                    'id': id,
                    'content': content,
                    '_': timestamp
                },
                dataType: "json",
                headers: {
                    "Authorization": token
                },
                success: function (msg) {
                    tijiao = 1;
                    if (msg.status) {
                        alert(msg.msg);
                        getInfo(id);
                    } else {
                        alert(msg.msg);
                        return false;
                    }
                },
                error: function (msg) {
                    tijiao = 1;
                    alert("网络错误,请重试");
                    return false;
                }
            });
        }
    </script>
</head>

<body style="background:white;overflow-x: hidden;">
<nav></nav>
<div class="mu3"></div>
<h1 class="fadeTitle">建议反馈</h1>


<div class="subver">
    <div class="comn">
        <div style="width:900px">
            <div class="ffp">
                <span><img src="img/sanjiao.png" style="padding-top:19px;width:13px"></span>
                <span><a href="feedback.html" class="falef">返回</a></span>
                <span><a href="feedback.html?fankui=1" class="myd">我的反馈</a></span>
            </div>

        </div>

        <div class="exen"><span class="fan">反馈详情</span></div>

    </div>

</div>


<div>
    <!--    -->
    <div class="quanbu">
        <div class="shuo">
            <div class="incop" id="div_feedback">

                <!--<div class="lass">-->
                <!--<div style="overflow:hidden;width:953px">-->
                <!--<div style="float:left;width:529px">-->
                <!--<h7 style="font-family:苹方-简 常规体">反馈问题:加入购物车后弹出的查看按钮无法点击转至</h7>-->
                <!--<p class="dian">在"职场充电"中,点击课程,(全套) 加入购物车候,弹出的 已添加成功,请到个人中心-我的收纳中下方的查看按钮无法点击,还是要点击个人中心,再点我的收纳中查看购买</p>-->
                <!--</div>-->
                <!--<div style="float:right">-->
                <!--<span class="data">2018-01-01</span>-->
                <!--</div>-->
                <!--</div>-->
                <!--</div>-->

                <!--<div class="dap">-->
                <!--<div>-->
                <!--<div class="den">-->
                <!--<h3>分析君:</h3>-->
                <!--<div class="miss">-->
                <!--<p>非常感谢你提供的问题</p>-->
                <!--<p>经过测试,点击[查看]按钮确实无法跳转我的收纳页,我们会尽快修复这个问题</p>-->
                <!--<p>另外,您也可以在将加入收纳后,点击页面的悬浮图标中的[GET按钮,直接跳转到"我的收纳"中</p>-->
                <!--</div>-->
                <!--</div>-->
                <!--<div class="wir">-->
                <!--<span>2018-02-05</span>-->
                <!--<p class="fu"><a href="#">回复</a></p>-->
                <!--</div>-->
                <!--</div>-->
                <!--<p class="nam"></p>-->
                <!--<textarea style="width:909px;height:70px;margin-top:9px;"></textarea>-->
                <!--<div>-->
                <!--<input style="position:absolute;opacity:0;" type="file" name="file" id="Album_img" accept="image/gif,image/jpeg,image/x-png"/>-->
                <!--<img style="width:15px" src="img/shangchuan (2).png">-->
                <!--<span>添加图片</span>-->
                <!--<input type="button" value="发送" class="send">-->
                <!--</div>-->
                <!--<div>-->


                <!--</div>-->

                <!--</div>-->
            </div>
            <div class="jhFengexian" style="display: none">
                <div style="border:1px solid #e8e8e8;width:998px;margin:0 auto;margin-top:20px;">
                </div>
                <p class="yijing"></p>
            </div>

        </div>
    </div>
</div>
<div class="fadeBack_footer"></div>
<script>
    $(function () {
        $('.summernote').summernote({
            height: 200,
            tabsize: 2,
            lang: 'zh-CN'
        });
    });
</script>
</body>

</html>
