<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="applicable-device" content="mobile">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <title>Datahoop 2.0 个人中心</title>
    <link rel="icon" href="img/favicon.png?v=0.19.11.21.11" type="image/x-icon">
    <link rel="shortcut icon" href="img/favicon.png?v=0.19.11.21.11" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="css/nav.css?v=0.19.11.21.11">
    <link rel="stylesheet" type="text/css" href="css/perscen.css?v=0.19.11.21.11">
    <link rel="stylesheet" type="text/css" href="css/style.css?v=0.19.11.21.11">
    <script type="text/javascript" src="js/jquery.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/url_ip.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/nav.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/lajax.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/perscen.js?v=0.19.11.21.11"></script>
    <script type="text/javascript" src="js/pageJudge.js?v=0.19.11.21.11"></script>
    <style>

    </style>
    <script src="js/url_ip.js"></script>
</head>

<body>
    <div>
        <nav></nav>
        <div class="typeArea">
            <div class="perscenL" data-item="zh">
                <!--左侧内容区-->
            </div>
            <div class="personR personR_zh">


                <!-- <div class="zhHead perscenBlock">
               <h2 class="perscen_blockTitl fl">我的空间</h2>
               <div class="fl" style="margin-top: 2.5px;">
                 <p class="zhMemoryBar"><span></span></p>
               </div>
               <span class="fl zoneUseCount">已使用0/0</span>
               <span class="zhAddMemory">增加容量</span>
             </div>
             -->

                <!-- <div class="jfCont perscenBlock">
              <h2 class="perscen_blockTitl">我的积分<a href="help_center.html?1&amp;6">什么是用户积分？</a></h2>
              <div class="jfFoo">
                <ul class="jfTab fl">
                  <li>222<br />CPDA</li>
                  <li>222<br />CDA</li>
                  <li>222<br />微课</li>
                  <li>222<br />Datahoop2</li>
                </ul>
                <p class="jfAll fl"><img src="img/icon/fixed_btn_wk.png" alt=""><span>999</span><a href="">积分变化详情</a></p>
              </div>
            </div> -->
                <!-- <div class="perscenBlock">
              <h2 class="perscen_blockTitl"><span class="x_shu_Name"></span><a href="help_center.html?1&amp;6">什么是<span class="x_shu_Name"></span>？</a></h2>
              <div class="xsbCont">
                <div class="xsb_num fl"><img src="ZJ_img1/ZJ1-1.fw.png" /><span>999</span></div>
                <p class="xsb_get fr">充值</p>
              </div>
            </div> -->
                <div class="xshuvipjfen">
                    <div class="xshuDiv">
                        <h2 class="perscen_blockTitl x_shu_Name"></h2>
                        <div class="xshuBg">
                            <img src="img/pic/xshu.png" alt="">
                            <span class="xshuCount">--</span>
                            <a href="javascript:;">了解<b class="x_shu_Name"></b></a>
                            <p class="btn">充值</p>
                            <div class="cb-rule">
                                <p>C币是Datahoop平台的电子货币，充值即可获得；</p>
                                <p>C币可用于购买Datahoop平台的使用权限、课程、算法以及存储空间；</p>
                                <p>C币和人民币之间是1:1的充值兑换率，平台不做溢价；</p>
                                <p>C币充值购买后不可退还和提现</p>
                            </div>
                        </div>
                    </div>
                    <div class="vipDiv">
                        <h2 class="perscen_blockTitl">我的会员</h2>
                        <div class="vipBg relative">
                            <p class="vipCount">--</p>
                            <a href="perscen-vip.html" class="knowvip">了解会员体系&gt;&gt;</a>
                        </div>
                    </div>

                    <div class="jfenDiv">
                        <div>
                            <h2 class="space" style="font-weight:bold;">
                                我的空间
                            </h2>
                            <div>
                                <div class="neir">
                                    <div>
                                        <div class="process-bar skin-green">
                                            <div class="pb-wrapper">
                                                <div class="pb-highlight"></div>
                                                <div class="pb-container">
                                                    <div class="pb-text">50%</div>
                                                    <div class="pb-value" style="height: 100%;width: 13%;background: #496FFF;border-radius: 4px;"></div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <p></p>
                                    <p></p>

                                    <div class="usee">已使用0.54m/20m</div>
                                    <!--                <p><a href="#">增加容量</a>-->
                                    <input type="button" name="popBox" value="增加容量" onclick="addRongliangList()" class="passwadq" style="background:white"></p>

                                </div>

                            </div>


                            <!--            <div class="typee">-->
                            <!--              -->
                            <!--              <div class="cenutt">-->
                            <!--              </div>-->
                            <!--            </div>-->
                            <!--            <div class="exetn">-->

                            <!--              <div class="widq">-->
                            <!--              </div>-->
                            <!--            </div>-->
                        </div>

                        <h2 class="perscen_blockTitl hide">积分</h2>
                        <p class="jfenCount hide">--</p>
                        <a href="help_center.html?1&6" style="display: none;">什么是用户积分?</a>
                    </div>
                </div>
                <div class="detailCont perscenBlock">
                    <dl>
                        <dt class="detailTab">
                        <p class="hide">积分详情</p>
                        <p class="active"><span class="x_shu_Name"></span>详情</p>
                    </dt>
                        <dd class="jfDetail">
                            <ul class="jfDetailHead">
                                <!-- <li class="com">来源</li> -->
                                <li class="countnum">订单编号</li>
                                <li class="tim">时间</li>
                                <li class="act">变化</li>
                                <li class="abstr">详情</li>
                                <li class="abstract">摘要</li>
                            </ul>
                            <div class="xshu_use_msg hide" style="margin-top: 20px;font-size: 14px;"></div>
                            <ul class="jfDetailCont" style="min-height: 180px;">
                                <!--犀数币使用详情-->
                            </ul>
                            <div class="ycl_page xshuDetail_listPag">
                                <div class="page_click pre_page" data-click="pre"><img src="img/weizuo.png"></div>
                                <span class="span left_dian">...</span>
                                <ul>

                                </ul>
                                <span class="span last_dian">...</span>
                                <div class="page_click next_page" data-click="nxt"><img src="img/weiyou.png"></div>
                                <p>共 <span class="all_page"></span> 页</p>
                                <input type="text" class="will_page">
                                <div class="page_click to_page" data-click="go">跳转</div>
                            </div>
                        </dd>
                    </dl>
                </div>
                <!-- <div class="yhqCont perscenBlock">
                    <h2 class="perscen_blockTitl">我的优惠券<a href="javascript:;">如何获取优惠劵？</a></h2>
                    <div class="hide coupon_no">暂无优惠券</div>
                    <ul class="coupon hide">
                        <li>
                            <div class="left relative">7<i>折</i></div>
                            <div class="right">
                                <p class="yh_active">新用户活动</p>
                                <p class="yh_goodsName mt5 mb5">购买<i>xxx商品</i></p>
                                <p class="yh_rightTime">使用时间: <i>2019-01-11</i></p>
                                <strong class="operate">去使用</strong>
                            </div>
                        </li>
                        <li class="expired">
                            <div class="left relative">7<i>折</i></div>
                            <div class="right">
                                <p class="yh_active">新用户活动</p>
                                <p class="yh_goodsName mt5 mb5">购买<i>xxx商品</i></p>
                                <p class="yh_rightTime">使用时间: <i>2019-01-11</i></p>
                                <strong class="operate">去使用</strong>
                            </div>
                        </li>
                    </ul>
                </div> -->
            </div>
        </div>
    </div>

    <div class="mu"></div>
    <div id="xshupayalertMu" class="hide">
        <div id="xshupayalert">
            <h2 class="titlt">
                <p><span class="x_shu_Name">&nbsp;</span></p>
                <i class="close">×</i>
            </h2>
            <div class="">
                <p class="titlt2">充值金额</p>
                <ul class="payCheck">
                    <li class="active" data-price="200">¥ 200</li>
                    <li data-price="500">¥ 500</li>
                    <li data-price="1000">¥ 1000</li>
                </ul>
                <input type="number" placeholder=" ¥ 其他金额， 请输入1-50000的整数 ">
                <p class="titlt2">支付方式</p>
                <div class="payType">
                    <p><i class="iCheck normal active"></i><img src="img/weixin.png" alt=""><span>微信支付</span></p>
                    <p><i class="iCheck disabled"></i><img src="img/zhifubao.png" alt=""><span>支付宝支付</span></p>
                    <div class="errTip"><span class="hide">请先填写/选择价格</span></div>
                </div>
            </div>
            <div class="btn">立即充值</div>
        </div>
    </div>
    <div id="wxerweimaMu" class="hide">
        <div id="wxerweima">
            <i class="close">×</i>
            <h2 class="title">微信支付¥<span class="money">--</span></h2>
            <div class="loader">
                <div class="loader-inner ball-pulse">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
            <img src="" alt="">
            <p class="paytip">使用微信扫描二维码进行支付</p>
            <p class="reload"><i></i>刷新重新获取二维码</p>
        </div>
    </div>
    <div id="zfberweimaMu" class="hide">
        <div id="zfberweima">
            <i class="close">×</i>
            <h2 class="title">支付宝支付¥<span class="money">--</span></h2>
            <div class="loader">
                <div class="loader-inner ball-pulse">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
            <img src="" alt="">
            <p class="paytip">使用支付宝扫描二维码进行支付</p>
            <p class="reload"><i></i>刷新重新获取二维码</p>
        </div>
    </div>
    <!--提示信息-->
    <div class="msg-box-wraper alertMsg hide">
        <div class="msg-box">
            <i class="msg-close">×</i>
            <h6 class="msg-img isOk"></h6>
            <h2>tip</h2>
        </div>
    </div>
    <!--增加容量==================第一个弹框================弹出框-->
    <div id="popLayer"></div>
    <div id="popBox">
        <div class="close">
            <div style="text-align:center;margin-top:20px;height:20px;color:#333333;font-size: 20px;font-family:苹方-简 常规体;position:relative">增加存储空间</div>
            <a href="javascript:void(0)" onclick="closeBox()" class="xp">X</a>
        </div>
        <p style="color:#333333;font-size:14px;margin:30px 30px">请选择储存空间</p>
        <div id="PriceRong">

        </div>
        <div class="main yhTaocan">
            <div class="sub1 activee sijiao-p activee-p" id="capacityLst0"></div>
            <div class="sub1" style="margin-left:21px" id="capacityLst1"></div>
            <div class="sub1" style="margin-left:21px" id="capacityLst2"></div>
        </div>
        <p class="yhPriceGe"> </p>
        <div class="yhMoneyList">
            <div class="payy">需支付</div>
            <div class="bib capacityLst0"></div>
            <div class="bib capacityLst1" style="display: none"></div>
            <div class="bib capacityLst2" style="display: none"></div>
        </div>
        <div class="sure">
            <!--                    <input type="button" value="确认选择">-->
            <input type="button" value="确认选择" onclick="popBoxTwo()">
        </div>
    </div>
    <!--增加容量==================第二个弹框================弹出框-->
    <div id="popLayerTwo" style="display: none"></div>
    <div id="popBoxTwo" style="display: none;width:400px;height:283px">
        <div class="close">
            <div style="text-align:center;margin-top:20px; color:#333333;font-size: 20px;font-family:苹方-简 常规体;position:relative">请输入支付密码</div>
            <a href="javascript:void(0)" onclick="closeBoxTwo()" class="xp">X</a>
        </div>
        <p class="yhPayMoney"> 支付金额</p>
        <p class="yhPayMoneyPrice">100C币 </p>
        <!--<textarea style="width:340px;height:40px;margin:20px 32px;" id="yhPassword"></textarea>-->
        <input type="password" style="width:340px;height:40px;margin:20px 32px;border:0.5px solid #9e9e9e" id="yhPassword">
        <div class="sure">
            <input type="button" value="确认选择" onclick="shopRongliang()">
        </div>
    </div>
    <input type="hidden" id="jhPrice">
    <input type="hidden" id="jhSize">
    <div class="msg-box-wraper alertMsg hide">
        <div class="msg-box">
            <i class="msg-close">×</i>
            <h6 class="msg-img"></h6>
            <h2><span>提示信息</span></h2>
        </div>
    </div>
    <div class="fadeBack_footer"></div>
</body>

</html>
<script>
    //    var mes = {
    //        "status": true,
    //        "data": [
    //            {
    //                "price": 100,
    //                "size": "100M"
    //            },
    //            {
    //                "price": 500,
    //                "size": "500M"
    //            },
    //            {
    //                "price": 800,
    //                "size": "1G"
    //            }
    //        ]
    //    };
    function addRongliangList() {
        $.GSHajax({
            url: '/pay/cprice',
            type: 'GET',
            success: function(msg) {
                if (msg.status) {
                    $.each(msg.data, function(key, v) {
                        $("#capacityLst" + key).html(v['size']);
                        $(".capacityLst" + key).html(v['price'] + "C币");
                        if (key == 0) {
                            $("#jhPrice").val(v['price'] + "C币");
                            $("#jhSize").val(v['size']);
                            $(".yhPayMoneyPrice").val(v['price'] + "C币");
                        }
                    });
                    popBox();
                } else {
                    alert("请求错误");
                }
            },
            error: function(msg) {
                alert("请求错误2");
                return false;
            }
        })
    }
    /*点击弹出第一个弹框*/
    function popBox() {
        $("#popBox").show();
        $("#popLayer").show();

    };
    /*点击关闭第一个弹框*/
    function closeBox() {
        $("#popBox").hide();
        $("#popLayer").hide();
    }
    //第二个弹框============================================第二个弹框
    /*关闭第一个弹框,并弹出第二个弹框*/
    function popBoxTwo() {
        //这个代表关闭第一个弹框的
        closeBox();
        //然后打开第二个弹框
        $("#popBoxTwo").show();
        $("#popLayerTwo").show();
    }
    /*关闭第二个弹框*/
    function closeBoxTwo() {
        $("#popBoxTwo").hide();
        $("#popLayerTwo").hide();
    }
    $('.sub1').click(function() {
        $(this).addClass("activee").siblings().removeClass("activee");
        $(this).addClass("activee-p").siblings().removeClass("activee-p");
        $(this).addClass("sijiao-p").siblings().removeClass("sijiao-p");
        var capacityLst = $(this).attr("id");
        var jhPrice = $("." + capacityLst).text();
        var jhsize = $(this).text();
        $(".bib").hide();
        $("." + capacityLst).show();
        $("#jhPrice").val(jhPrice);
        $("#jhSize").val(jhsize);
        $(".yhPayMoneyPrice").html(jhPrice);
    });

    function shopRongliang() {
        var timestamp = (new Date()).getTime();
        var password = $("#yhPassword").val();
        var size = $("#jhSize").val();
        var price = $("#jhPrice").val();
        if (password == "" || password == null || password == undefined) {
            $('.alertMsg').showMsg({
                isImg: 'isNo',
                h2txt: '请输入密码',
                setTime: 2000
            });
            return;
        }
        price = price.split("C币").join("");
        $.GSHajax({
            url: '/pay/buycapacity',
            data: {
                'price': price,
                'size': size,
                'password': password,
                'timestamp': timestamp
            },
            type: 'POST',
            success: function(msg) {
                if (msg.status) {
                    alert(msg.msg);
                    closeBoxTwo();
                    history.go(0)
                } else {
                    alert(msg.msg);
                }
            },
            error: function(msg) {
                alert("支付错误2");
                return false;
            }
        })
    }
</script>
<script>
    //支付轮询
    function payLx(num, price) { //payLx(payLastDatas.num)
        if ($("#xshupayalert .payType p:eq(0)").find("i").hasClass("active")) {
            if (price) {
                var NeedSrc = url_ip + '/pay/recharge/?pay_price=' + price + '&num=' + num + '&channel=wechat_csb' + '&_=' + (new Date().getTime());
                $('#wxerweima .money').text(price);
            }
            $('#wxerweima img').attr({
                src: NeedSrc
            });
        } else {
            if (price) {
                var NeedSrc = url_ip + '/pay/recharge/?pay_price=' + price + '&num=' + num + '&channel=alipay_csb' + '&_=' + (new Date().getTime());
                $('#zfberweima .money').text(price);
            }
            $('#zfberweima img').attr({
                src: NeedSrc
            });
        }
        var opy_time = 60; // 支付时间
        clearInterval(sss)
        var sss = setInterval(function() {
            opy_time--;
            if (opy_time <= 0) {
                clearInterval(sss);
            } else {
                if (opy_time % 5 == 0) {
                    $.GSHajax({
                        url: '/pay/recharge_check/',
                        data: {
                            num: num
                        },
                        success: function(res) {
                            if (res.status) {
                                clearInterval(sss);
                                $('.alertMsg').showMsg({
                                    isImg: 'isOk',
                                    h2txt: res.msg,
                                    setTime: 2000
                                });
                                setTimeout(function() {
                                    window.location.reload();
                                }, 2000)
                                return;
                            }
                        }
                    })
                }
            }
        }, 1000)
    }
    //犀数详情
    var xshu_pre_count = 5; //犀数详情每页显示条数
    var xshu_All_page = 0; //犀数详情总页数
    function xshuDetailFn(cur_page, xshu_pre_count) {
        $('.jfDetailCont').html('');
        $.GSHajax({
            url: '/personal/coindiscount/',
            data: {
                cur_page: cur_page,
                pre_count: xshu_pre_count
            },
            success: function(res) {
                if (res.status) {
                    if (res.data.length == 0) {
                        $('.xshu_use_msg').show().text(res.msg);
                    } else {
                        xshu_All_page = Math.ceil(res.all_num / xshu_pre_count);
                        for (var i = 0; i < res.data.length; i++) {
                            var oHtml = '<li>' +
                                // '<p class="com">'+res.data[i].details+'</p>'+
                                '<p class="countnum">' + `<a href="perscen-dd.html#${res.data[i].order_id}">` + `${res.data[i].order_id ? res.data[i].order_id : ''}` + `</a>` +'</p>' +
                                '<p class="tim">' + (res.data[i].time).substr(0, 10) + '&nbsp; ' + (res.data[i].time).split('.')[0].split('T')[1] + '</p>' +
                                '<p class="act">' + (res.data[i].condition == 1 ? '+' : '-') + res.data[i].num + '</p>' + //1充值, 2使用
                                `<p class="abstr" title="${res.data[i].details}">${res.data[i].details}</p>` +
                                '<p class="abstract">' + `${res.data[i].remark?res.data[i].remark : ''}` + '</p>' +
                                '</li>'
                            $('.jfDetailCont').append(oHtml)
                        }
                        pageJudgeFn('.xshuDetail_listPag', xshu_All_page, cur_page);
                    }
                } else {
                    $('.xshu_use_msg').show().text(res.msg);
                }

            }
        })
    }

    $(function() {
        var _order_all = _price_all = 0;
        // 判断用户多次点击刷新二维码
        var kaig = true;
        //获取值绑定
        $.GSHajax({
                url: '/personal/myaccount/',
                success: function(res) {
                    // 我的空间
                    var zoneGrade = res.data.mystorage.mysize / res.data.mystorage.maxsize;
                    var zoneMyLength = $('.pb-text').outerWidth() * zoneGrade || 0;
                    $('.pb-value').animate({
                        width: zoneMyLength
                    }, 300);
                    // $('.zhHead .zoneUseCount').html('').html('已使用'+res.data.mystorage.mysize+'M/'+res.data.mystorage.maxsize+'M');
                    $('.usee').html('').html('已使用' + res.data.mystorage.mysize + 'M/' + res.data.mystorage.maxsize + 'M');
                    $('.pb-text').html('').html(((res.data.mystorage.mysize / res.data.mystorage.maxsize) * 100).toFixed(2) + '%');
                    // 积分
                    $('.jfenDiv .jfenCount').text(res.data.score.all);
                    //犀数币
                    $('.xshuDiv .xshuCount').text(res.data.coin_num);
                    $('.xshuDiv .xshuCount').attr("title", res.data.coin_num);
                    //优惠券
                    if (res.data.my_dis.length == 0) {
                        $('.yhqCont .coupon_no').show();
                    }
                    //会员
                    $('.vipDiv .vipCount').text(res.data.singal)
                    if(res.data.singal === '普通用户') {
                        $('.knowvip').hide();
                    }
                }
            })
            //犀数详情
        xshuDetailFn(1, xshu_pre_count);
        //犀数详情分页
        $('.xshuDetail_listPag').on('click', '.page_click', function() {
                pageClickFn('.xshuDetail_listPag', xshu_All_page, this, xshuDetailFn, xshu_pre_count)
            })
            //支付弹窗
        $('.xshuvipjfen .xshuDiv').on('click', '.btn', function() {
            $('#xshupayalertMu').fadeIn();
            $('.errTip span').hide();
        })
        $('#xshupayalert').on('click', '.close', function() {
                $('#xshupayalertMu').fadeOut();
            })
            //选择支付金额
        $('#xshupayalert .payCheck').on('click', 'li', function() {
            $(this).addClass('active').siblings().removeClass('active');
        });

        //选择支付方式
        $('#xshupayalert .payType').on('click', 'p', function() {
            $(this).children("i").addClass('normal').end().siblings().children("i").removeClass('normal');
            $(this).children("i").removeClass('disabled').end().siblings().children("i").addClass('disabled');
            $(this).children("i").addClass('active').end().siblings().children("i").removeClass('active');
        });
        //支付输入框值变
        $('#xshupayalert').on('input propertychange', function() {
                $('#xshupayalert .payCheck li').removeClass('active');
                var nowVal = $('#xshupayalert input').val();
                // var regex = /(^[1-4][0-9]{4,4}$)|(^[1-9][0-9]{0,3}$)|50000/;
                if (nowVal.indexOf(".") == -1) {
                    if (nowVal < 0) {
                        $('#xshupayalert input').val(1);
                    } else if (nowVal > 50000) {
                        $('#xshupayalert input').val(50000);
                    }
                } else {
                    $('#xshupayalert input').val(nowVal.substring(0, nowVal.indexOf('.')));
                }
            })
            //充值出二维码
        $('#xshupayalert').on('click', '.btn', function() {
            var pay_price1 = $('#xshupayalert input').val() - 0;
            var pay_price2 = $('#xshupayalert .payCheck li.active').attr('data-price') - 0;
            var pay_price = 0;
            if (pay_price2) {
                pay_price = pay_price2;
            } else {
                var regex = /(^[1-4][0-9]{4,4}$)|(^[1-9][0-9]{0,3}$)|50000/;
                if (regex.test(pay_price1)) {
                    pay_price = pay_price1;
                } else {
                    $('.errTip span').show();
                    return false; //终止
                }
            }
            $(".loader").css("display", "flex");
            $.GSHajax({
                url: '/pay/creatcoinorder/',
                data: {
                    pay_price: pay_price
                },
                success: function(res) {
                    _price_all = res.data.price;
                    _order_all = res.data.num;
                    if (res.status) {
                        if ($("#xshupayalert .payType p:eq(0)").find("i").hasClass("active")) {
                            var NeedSrc = url_ip + '/pay/recharge/?pay_price=' + res.data.price + '&num=' + res.data.num +
                                '&channel=wechat_csb' + '&_=' + (new Date().getTime());
                            $('#wxerweima .money').text(res.data.price);
                            $('#wxerweima img').attr({
                                src: NeedSrc
                            });
                            $('#wxerweima .reload').attr({
                                'data-ord': res.data.num
                            });
                            $('#wxerweimaMu').fadeIn();
                            // payLx(res.data.num, res.data.price);
                        } else {
                            var NeedSrc = url_ip + '/pay/recharge/?pay_price=' + res.data.price + '&num=' + res.data.num +
                                '&channel=alipay_csb' + '&_=' + (new Date().getTime());
                            $('#zfberweima .money').text(res.data.price);
                            $('#zfberweima img').attr({
                                src: NeedSrc
                            });
                            $('#zfberweima .reload').attr({
                                'data-ord': res.data.num
                            });
                            $('#zfberweimaMu').fadeIn();
                            // payLx(res.data.num, res.data.price);
                        }
                    } else {
                        //获取失败
                    }
                }
            })
        });
        //微信二维码关闭
        $('#wxerweima').on('click', '.close', function() {
            $('#wxerweimaMu').fadeOut();
        });
        //支付宝二维码关闭
        $('#zfberweima').on('click', '.close', function() {
            $('#zfberweimaMu').fadeOut();
        });
        //微信刷新重新获取二维码
        $('#wxerweima').on('click', '.reload', function() {
            if (kaig) {
                payLx(_order_all, _price_all);
                $(".loader").css("display", "flex");
                kaig = false;
            }
        });
        //支付宝刷新重新获取二维码
        $('#zfberweima').on('click', '.reload', function() {
            if (kaig) {
                payLx(_order_all, _price_all);
                $(".loader").css("display", "flex");
                kaig = false;
            }
        });
        // 判断微信二维码是否加载完成
        var wxerweima = document.getElementById("wxerweima");
        wxerweima.addEventListener("load", function(event) {
            var ev = event ? event : window.event;
            var elem = ev.target;
            if (elem.tagName.toLowerCase() == 'img') {
                $(".loader").css("display", "none");
                kaig = true;
            }
        }, true);
        // 判断支付宝二维码是否加载完成
        var zfberweima = document.getElementById("zfberweima");
        zfberweima.addEventListener("load", function(event) {
            var ev = event ? event : window.event;
            var elem = ev.target;
            if (elem.tagName.toLowerCase() == 'img') {
                $(".loader").css("display", "none");
                kaig = true;
            }
        }, true);
    })
</script>
